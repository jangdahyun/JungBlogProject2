<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>마이페이지</title>
    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <!-- 구글 아이콘 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <!-- Core theme CSS (includes Bootstrap)-->
    <!-- UIkit CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.17.11/dist/css/uikit.min.css">
    
    <!-- 부트스트랩 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Ajax처리를 위한 포함 -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <!-- UIkit JS -->
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.17.11/dist/js/uikit.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/uikit@3.17.11/dist/js/uikit-icons.min.js"></script>
    
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <!-- 커스텀 -->
    <link href="/css/my/header.css" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif; /* 한글 폰트 지정 */
            margin: 0; /* 바디의 마진을 0으로 설정하여 여백 제거 */
            padding: 0; /* 바디의 패딩을 0으로 설정하여 여백 제거 */
            background-color: #F9FBFC; /* 배경색 지정 */
            display: flex; /* Flex 레이아웃 사용 */
            min-height: 100vh; /* 최소 높이를 화면의 높이로 설정하여 컨테이너가 항상 화면에 꽉 차게 함 */
            align-items: center; /* 수직 가운데 정렬 */
            justify-content: center; /* 수평 가운데 정렬 */
        }
        
        .menuBar {
            text-align: right; /* 메뉴 오른쪽 정렬 */
            margin-top: 20px; /* 위쪽 여백 */
            margin-right: 30px; /* 오른쪽 여백 */
            cursor: pointer; /* 커서 모양 변경 */
        }
        
        #icon {
            margin-right: 10px; /* 아이콘 간격 */
        }
        
        table {
            width: 100%; /* 테이블 너비 100% */
            background-color: #fff; /* 테이블 배경색 */
            border-collapse: collapse; /* 테두리 병합 */
            border-radius: 8px; /* 테두리 둥글게 */
            overflow: hidden; /* 오버플로우 처리 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 그림자 */
            margin-top: 30px; /* 위쪽 여백 */
        }
        
        th, td {
            padding: 12px 15px; /* 셀 안 패딩 */
            text-align: left; /* 텍스트 왼쪽 정렬 */
            border-bottom: 1px solid #dee2e6; /* 하단 테두리 */
        }
        
        th {
            background-color: #345747; /* 헤더 배경색 */
            color: #fff; /* 헤더 텍스트색 */
            font-weight: 600; /* 헤더 폰트 굵기 */
            text-transform: uppercase; /* 헤더 텍스트 대문자 변환 */
        }
        
        tbody tr:hover {
            background-color: #f2f2f2; /* 호버시 배경색 */
        }
        
        .pagination {
            display: flex; /* 페이징을 가로로 배치 */
            justify-content: center; /* 가운데 정렬 */
            margin-top: 20px; /* 위쪽 여백 */
        }
        
        .pagination a {
            color: #007bff; /* 페이지 링크 색상 */
            padding: 8px 16px; /* 페이지 링크 패딩 */
            text-decoration: none; /* 링크 텍스트 밑줄 제거 */
            border: 1px solid #007bff; /* 링크 테두리 */
            margin: 0 4px; /* 링크 간격 */
            border-radius: 4px; /* 링크 둥글게 */
            transition: background-color 0.3s; /* 배경색 변환 트랜지션 */
        }
        
        .pagination a:hover {
            background-color: #007bff; /* 호버시 배경색 */
            color: #fff; /* 호버시 텍스트색 */
        }
        
        .pagination .active a {
            background-color: #007bff; /* 활성 페이지 배경색 */
            color: #fff; /* 활성 페이지 텍스트색 */
            pointer-events: none; /* 클릭 비활성화 */
        }
        
        .pagination .disabled a {
            color: #ccc; /* 비활성 페이지 텍스트색 */
            pointer-events: none; /* 클릭 비활성화 */
        }
    </style>

<body style="display: flex;">
	<th:block th:if="${categoryNum != null}">
		<input type="hidden" id="categoryNum" th:value="${categoryNum}"/>
	</th:block>
	<!-- header -->
	<th:block th:insert="~{/my/header.html}"></th:block>
	<div id="container" class="container" style="margin-left: 30px; background: #F9FBFC; width: 1000px; height: 800px;">
		<div id="content" class="content">
			<div id="main" role="main">
				<div id="headertop" class="headertop">
					<div class="menuBar" style="text-align: right; margin-top: 20px; margin-right: 30px; cursor: pointer; ">
						<span id="icon" class="material-symbols-outlined" onclick="gotohome()">home</span>
						<span id="icon" class="material-symbols-outlined" onclick="gotoblog()">book_2</span>
                		<span id="icon" class="material-symbols-outlined" onclick="file()">folder_open</span>
                		<span id="icon" class="material-symbols-outlined" onclick="gallery()">gallery_thumbnail</span>
                		<span id="icon" class="material-symbols-outlined" onclick="gotovideo()">videocam</span>
                		<span id="icon" class="material-symbols-outlined" onclick="news()">news</span>
                		
					</div>
					<table id="incident_list_table" class="uk-table uk-table-hover uk-table-divider uk-table-middle uk-table-small">
						<colgroup>
							<col width="45px" />
							<col width="120px" />
							<col width="200px" />
							<col width="95px" />
							<col width="90px" />
							<col width="60px" />
							<col width="60px" />
							<col width="60px" />
						</colgroup>
						<thead>
							<tr>
								<th class="" style="line-height: 2">NO</th>
								<th class="" >
									<select class="uk-select" id="selectBox" style="height: 25px" onchange="handleCategoryChange()">
						                <option selected value="0">카테고리</option>
						                <option th:each="category : ${categoryList}" th:value="${category}" th:selected="${(category == '블로그' ? 1 : category == '자료실' ? 2 : 4) == categoryNum}">[[${category}]]</option>
						            </select>
								</th>
								<th class="" style="line-height: 2">제목</th>
								<th class="" style="line-height: 2">글쓴이</th>
								<th class="" style="line-height: 2">게시일</th>
								<th class="" style="line-height: 2">조회수</th>
								<th class="" style="line-height: 2">좋아요</th>
								<th class="" style="line-height: 2">숨김여부</th>
							</tr>
						</thead>
						<tbody>
							<tr th:if="${#lists.isEmpty(pv.list)}">
								<td colspan="8">등록된 글이 없습니다.</td>
				    		</tr>
							<tr th:each="vo, vs : ${pv.list}" th:onclick="view(this)" style="cursor: pointer;">
								<td style="display: none;" class="idx">[[${vo.idx}]]</td>
								<td>[[${pv.totalCount - (pv.currentPage-1)*pv.sizeOfPage -
									vs.index}]]</td>
								<td class="categoryName">[[${vo.categoryName}]]</td>
								<td th:text="${#strings.length(vo.title) > 10 ? #strings.substring(vo.title, 0, 10) + '...' : vo.title}"></td>
								<td>[[${vo.member.nickName}]]</td>
								<td th:text="${#dates.format(vo.regDate, 'yy-MM-dd')}"></td>
								<td>[[${vo.readCount}]]</td>
								<td>[[${vo.countHeart}]]</td>
								<td style="text-align: center;">[[${vo.deleted == 0 ? 'X' : 'O'}]]</td>
							</tr>
							</th:block>
						</tbody>
					</table>
					<div id="page" style="display: flex; align-items: center;justify-content: center;">
						[(${pv.pageList})]
					</div>
				</div>
			</div>
		</div>	
	</div>
    <script type="text/javascript">
    	$(function(){
    		let categoryNum = $("#categoryNum").val();
    		
    		
    		$("#page a").click(function(e){
    			e.preventDefault();
    			content = ""
    			const pageNum = $(this).text();
    			if(categoryNum == null){
    				content = `?p=${pageNum}`
    			} else {
    				content = `?p=${pageNum}&categoryNum=${categoryNum}`
    			}
    			
    			location.href = content;
    		})
    		
    	})
    	
    
    function view(obj) {
 		 // 클래스 이름이 idx인 요소의 텍스트 가져오기
 	    let idxText = obj.querySelector('.idx').innerHTML;
 	    // 클래스 이름이 categoryName인 요소의 텍스트 가져오기
 	    let categoryNameText = obj.querySelector('.categoryName').innerHTML;

 	   switch (categoryNameText) {
       case "블로그": // 블로그 카테고리 선택 시
           // 블로그 페이지로 이동
           location.href = `/blog/view/my/${idxText}`;
           break;
           
       case "자료실": // 자료실 카테고리 선택 시
           // 자료실 페이지로 이동
           location.href = `/fileboard/my/${idxText}`;
           break;
           
       case "Gallery": // 갤러리 카테고리 선택 시
           // 갤러리 페이지로 이동
           location.href = `/gallery/my/${idxText}`;
           break;
       default:
           // 기본적으로 수행할 동작
           break;
  }

    }

	 function gotohome() {
	        // 여기에 이동할 주소를 입력합니다.
	        var address = "/";
	        // 현재 창에서 해당 주소로 이동합니다.
	        window.location.href = address;
	    }
	 
	 function gotoblog() {
	        // 여기에 이동할 주소를 입력합니다.
	        var address = "/blog";
	        // 현재 창에서 해당 주소로 이동합니다.
	        window.location.href = address;
	    }
	 
	 function gallery() {
        // 여기에 이동할 주소를 입력합니다.
        var address = "/gallery";
        // 현재 창에서 해당 주소로 이동합니다.
        window.location.href = address;
    }
	 
	 function file() {
	        // 여기에 이동할 주소를 입력합니다.
	        var address = "/fileboard";
	        // 현재 창에서 해당 주소로 이동합니다.
	        window.location.href = address;
	    }
	
	 function download() {
	        // 여기에 이동할 주소를 입력합니다.
	        var address = "/gallery";
	        // 현재 창에서 해당 주소로 이동합니다.
	        window.location.href = address;
	 }
	 
	 function gotovideo() {
	        // 여기에 이동할 주소를 입력합니다.
	        var address = "/videoboard";
	        // 현재 창에서 해당 주소로 이동합니다.
	        window.location.href = address;
		}
	 
	function news() {
        // 여기에 이동할 주소를 입력합니다.
        var address = "/news";
        // 현재 창에서 해당 주소로 이동합니다.
        window.location.href = address;
	}
	 
	function handleCategoryChange() {
	        // 선택한 카테고리의 값을 가져옴
	        var selectedCategory = document.getElementById("selectBox").value;

	        // 선택한 카테고리에 따라 동작을 수행
	        switch (selectedCategory) {
	            case "0":   //전체 보기
	                // 전체 페이지로 이동
	                location.href = `?p=1`;
	                break;
	                
	            case "블로그": // 블로그 카테고리 선택 시
	                // 블로그 페이지로 이동
	                location.href = `?p=1&categoryNum=1`;
	                break;
	                
	            case "자료실": // 자료실 카테고리 선택 시
	                // 자료실 페이지로 이동
	                location.href = `?p=1&categoryNum=2`;
	                break;
	                
	            case "QnA": // 갤러리 카테고리 선택 시
	                // 갤러리 페이지로 이동
	                location.href = `?p=1&categoryNum=5`;
	                break;
	                
	            case "Gallery": // 갤러리 카테고리 선택 시
	                // 갤러리 페이지로 이동
	                location.href = `?p=1&categoryNum=4`;
	                break;
	            default:
	                // 기본적으로 수행할 동작
	                break;
	       }
	}
	</script>
</body>
</html>